<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>7 Letters — Forgive Me</title>
  <meta name="description" content="Interactive apology page — letters, videos, playful animations." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@400;600;800&family=Crimson+Pro:ital,wght@0,400;0,600;1,500&display=swap" rel="stylesheet">
  <style>
    /* -------------------- Reset & base -------------------- */
    :root{
      --bg:#fff4fb;
      --ink:#222;
      --muted:#666;
      --rose:#ff6b81;
      --rose-deep:#e63946;
      --glass: rgba(255,255,255,0.6);
      --accent:#ffd1e0;
      --card:#fff;
      --shadow: 0 12px 40px rgba(0,0,0,.12);
      --soft-shadow: 0 6px 18px rgba(0,0,0,.08);
      --parchment:#fffaf0;
      --seal:#b61d3a;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(800px 400px at 5% -10%, #fff0f6, transparent),
        linear-gradient(180deg,#fff,#fffaf7);
      color:var(--ink);
      -webkit-font-smoothing:antialiased;
      overflow-x:hidden;
      scroll-behavior:smooth;
    }
    .container{max-width:1100px;margin:0 auto;padding:28px}
    h1,h2{margin:0 0 12px 0}
    p{margin:0 0 12px 0}
    .center{text-align:center}
    .muted{color:var(--muted)}
    button{font-weight:700}
    .btn{
      background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
      border:1px solid rgba(0,0,0,0.06);
      padding:10px 14px;border-radius:999px;cursor:pointer;
      box-shadow:var(--soft-shadow);
    }
    .btn:hover{transform:translateY(-3px);transition:transform .2s}

    /* -------------------- floating sparkles -------------------- */
    .sparkles{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden}
    .spark{position:absolute;width:10px;height:10px;border-radius:50%;background:linear-gradient(180deg,#fff,#ffd1e0);opacity:.9;filter:blur(.6px);transform:translateY(10vh);}

    /* -------------------- header / headline -------------------- */
    header{
      position:sticky;top:0;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.6));
      backdrop-filter: blur(10px);border-bottom:1px solid rgba(255,220,235,.7); z-index:5;
    }
    .brand{display:flex;align-items:center;justify-content:space-between;gap:12px}
    #brandTitle{font-size:1.6rem;font-weight:800;letter-spacing:0.3px}
    .subtitle{font-size:.95rem}

    /* -------------------- section blocks -------------------- */
    .block{background:var(--card);border-radius:16px;padding:18px;margin:16px 0;box-shadow:var(--shadow)}
    .section-title{display:flex;align-items:center;gap:10px;margin-bottom:12px}
    .section-title h2{font-size:1.2rem}

    /* -------------------- DONKEY -------------------- */
    .donkey-card{position:relative;overflow:hidden;border-radius:12px}
    .donkey-img{width:100%;height:480px;max-height:64vh;object-fit:cover;border-radius:12px;transform-origin:center center;opacity:0;transform:scale(1.06);transition:transform .9s cubic-bezier(.2,.9,.2,1),opacity .9s}
    .donkey-img.loaded{opacity:1;transform:scale(1);}
    .donkey-img:hover{transform:scale(1.02) rotate(-1deg) translateY(-4px)}
    .donkey-heart{position:absolute;pointer-events:none;right:20px;bottom:20px;font-size:28px;opacity:.95;transform:translateY(20px);animation:pop 1.6s infinite ease-in-out;}
    @keyframes pop{0%{transform:translateY(0) scale(.95)}50%{transform:translateY(-8px) scale(1.05)}100%{transform:translateY(0) scale(.95)}}

    /* -------------------- DIL KA HAAL -------------------- */
    .dil-wrap{display:grid;grid-template-columns:1fr;gap:18px;align-items:center;padding:20px}
    .heart-frame{position:relative;border-radius:20px;padding:12px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .heart-bg{position:absolute;inset:0;background:radial-gradient(circle at 20% 20%, rgba(246, 187, 208, .12), transparent 15%);pointer-events:none}
    .dil-player{
      position:relative;z-index:3;width:100%;max-width:920px;border-radius:14px;overflow:hidden;box-shadow:0 20px 60px rgba(230,60,100,.08);
      transform:translateY(20px);opacity:0;transition:transform .8s ease,opacity .8s;
      border:6px solid rgba(255,230,240,.6);
      background:#000;
    }
    .dil-player.visible{transform:translateY(0);opacity:1}
    .heart-pulse{position:absolute;inset:-8px;border-radius:26px;pointer-events:none;box-shadow:0 0 0 0 rgba(230,60,100,0.08);animation:beat 1.6s infinite;mix-blend-mode:screen}
    @keyframes beat{0%{box-shadow:0 0 0 0 rgba(230,60,100,.08)}40%{box-shadow:0 0 30px 8px rgba(230,60,100,.08)}100%{box-shadow:0 0 0 0 rgba(230,60,100,.08)}}
    .music-note{position:absolute;width:24px;height:24px;opacity:.12;filter:blur(.6px)}

    /* -------------------- THEATER -------------------- */
    .theater-wrap{position:relative;padding:0 12px}
    .curtains{position:relative;height:0;overflow:visible}
    .curtain{position:absolute;top:-2px;bottom:-2px;width:52%;background:linear-gradient(180deg,#7a0c23,#b51a3c);box-shadow:inset 0 0 30px rgba(0,0,0,.25)}
    .curtain.left{left:-2px;border-radius:12px 0 0 12px;transform:translateX(0)}
    .curtain.right{right:-2px;border-radius:0 12px 12px 0;transform:translateX(0)}
    .screen{position:relative;border-radius:16px;overflow:hidden;background:#000;box-shadow:var(--shadow)}
    .screen .media-frame{width:100%;height:56.25vw;max-height:60vh;border:0;display:block}

    /* -------------------- POOP MY FACE (formerly Pie) -------------------- */
    .pie-area .face-wrap{position:relative;display:flex;justify-content:center}
    .face-img{width:260px;height:260px;border-radius:50%;object-fit:cover;box-shadow:var(--soft-shadow);border:6px solid #ffe4ee;cursor:pointer;user-select:none}
    .pie-button{
      background:linear-gradient(180deg,#fff,#ffeeee);
      border:1px solid #ffd4df; padding:10px 14px;border-radius:999px;cursor:pointer;font-weight:800;
      box-shadow:var(--soft-shadow)
    }
    .pie-button:hover{transform:translateY(-2px)}
    .poop-emoji{
      position:absolute; font-size:64px; line-height:1; will-change:transform, opacity;
      pointer-events:none; user-select:none; filter: drop-shadow(0 8px 30px rgba(0,0,0,.15));
      transform: translateY(-200px) scale(.6) rotate(0deg); opacity:0;
    }
    #pieSection.shake{animation:shake .3s}
    @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-3px)}50%{transform:translateX(3px)}75%{transform:translateX(-2px)}100%{transform:translateX(0)}}

    /* -------------------- LETTERS -------------------- */
    .letter-area .center{display:flex;flex-direction:column;align-items:center}
    #letterHeadline{font-weight:800;color:#a62b6a;background:linear-gradient(180deg,#fff,#fffaf6);padding:10px 14px;border-radius:999px;border:1px solid #ffdfe9;cursor:pointer;box-shadow:var(--soft-shadow)}
    .envelope-viewport{position:relative;width:70%;height:300px;margin:14px auto;perspective:1200px;display:grid;place-items:center}
    .envelope{position:relative;width:100%;height:100%;border-radius:16px;background:linear-gradient(180deg,#ffe6ee,#fff);box-shadow:var(--shadow);transform-style:preserve-3d;transition:transform .6s cubic-bezier(.2,.9,.2,1);cursor:pointer}
    .envelope .face,.envelope .back{position:absolute;inset:0;border-radius:16px;display:grid;place-items:center;font-weight:800;color:#a62b6a}
    .envelope .face{backface-visibility:hidden}
    .envelope .back{transform:rotateY(180deg);background:linear-gradient(180deg,#fff,#ffe6ee)}
    .envelope.flipped{transform:rotateY(180deg)}
    .letter-sheet{
      position:absolute;inset:8px;border-radius:12px;background:var(--parchment);box-shadow:inset 0 0 0 2px #ffe4ec, var(--soft-shadow);
      transform:translateY(6px) scale(.98);opacity:0;transition:transform .6s cubic-bezier(.2,.9,.2,1),opacity .6s;
      padding:16px 18px 12px 18px;font-family: "Crimson Pro", Georgia, serif; color:#5b2d38; overflow:hidden
    }
    .letter-sheet.visible{opacity:1;transform:translateY(0) scale(1)}
    .stamp{position:absolute;right:16px;top:12px;border:2px dashed #d46; padding:6px 12px; border-radius:6px; font-size:.85rem; opacity:.8}
    .letter-meta{display:flex;justify-content:space-between;color:#9a435b;margin-bottom:8px;font-weight:700}
    .letter-title{font-family:"Great Vibes", cursive;font-size:1.8rem;margin-top:2px;color:#a62b6a}
    .letter-content{max-height:270px; overflow:auto; padding-right:6px}
    .letter-content ul{margin:8px 0 0 18px}
    .letter-content li{margin:6px 0}
    .signature{margin-top:8px; font-family:"Great Vibes", cursive; font-size:1.3rem; color:#a8334a; text-align:right}
    .letter-text-line{opacity:0;transform:translateY(6px);transition:opacity .45s ease,transform .45s ease}
    .editor-ui{display:flex;flex-direction:column;gap:8px;margin-top:8px;width:88%}
    textarea.editor{width:100%;min-height:180px;padding:12px;border-radius:8px;border:1px solid #ffdfe9;font-family:Georgia,serif;font-size:1rem}
    .letter-tabs{display:flex; gap:6px; justify-content:center; margin-top:8px}
    .letter-tab{padding:8px 12px; border-radius:999px; background:linear-gradient(180deg,#fff,#fffaf6); border:1px solid #ffdfe9; cursor:pointer; box-shadow:var(--soft-shadow); font-weight:700; color:#a62b6a}
    .letter-tab[aria-selected="true"]{background:linear-gradient(180deg,#ffe6ef,#fff); outline:2px solid #ffc2d6}
    .letter-cta{display:flex; gap:8px; justify-content:center; margin-top:8px}

    /* responsive */
    @media (max-width:880px){
      .donkey-img{height:44vh}
      .screen .media-frame{height:32vh}
      .envelope-viewport{width:92%;height:260px}
      .letter-content{max-height:220px}
    }
    @media (prefers-reduced-motion: reduce){
      .donkey-img,.dil-player,.screen .media-frame,.letter-sheet{transition:none!important;animation:none!important}
    }
  </style>
</head>
<body>

  <div class="sparkles" id="sparkles" aria-hidden="true"></div>

  <header>
    <div class="brand container">
      <div>
        <h1 id="brandTitle">From the Stupidest Donkey Alive…</h1>
        <div class="subtitle muted">A small interactive page — open letters when you're ready.</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn" id="editToggle" aria-pressed="false">✏️ Edit: Off</button>
        <button class="btn" id="resetAll">↺ Reset</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- DONKEY -->
    <section class="block donkey" id="donkeySection" aria-labelledby="donkeyTitle">
      <div class="section-title"><h2 id="donkeyTitle">🐴 Donkey Love</h2></div>
      <div class="donkey-card">
        <img id="donkeyImg" class="donkey-img" src="donkeyLove.jpg" alt="Donkey photo">
        <div class="donkey-heart">💘</div>
      </div>
    </section>

    <!-- DIL -->
    <section class="block dil-wrap" id="dilSection" aria-labelledby="dilTitle">
      <div class="section-title"><h2 id="dilTitle">💓 Dil Ka Jo Haal Hai</h2></div>
      <div class="heart-frame" role="region" aria-label="dil video">
        <div class="heart-bg"></div>
        <div class="dil-player" id="dilPlayer">
          <div class="heart-pulse" aria-hidden="true"></div>
          <video id="dilVideo" playsinline preload="metadata" controls>
            <source src="DilKaHaal.mp4" type="video/mp4">
            Your browser doesn't support this video.
          </video>
        </div>
      </div>
    </section>

    <!-- THEATER -->
    <section class="block theater-wrap" id="theaterSection" aria-labelledby="theaterTitle">
      <div class="section-title"><h2 id="theaterTitle">🎬 Perfect Together — The Short Film</h2></div>
      <div class="curtains" aria-hidden="true" style="height:0;">
        <div class="curtain left" id="curtainLeft"></div>
        <div class="curtain right" id="curtainRight"></div>
      </div>
      <div class="screen" id="screen">
        <iframe
          id="perfectFrame"
          class="media-frame"
          src="https://drive.google.com/file/d/1EwD4pr9sEOEdrvRQwVl-eoyAsDWJH0fg/preview"
          allow="autoplay; fullscreen"
          allowfullscreen
          title="Perfect Together (Drive Embed)"></iframe>
      </div>
    </section>

    <!-- POOP (replaces PIE) -->
    <section class="block pie-area" id="pieSection" aria-labelledby="pieTitle">
      <div class="section-title"><h2 id="pieTitle">💩 Poop My Face (for fun)</h2></div>
      <div class="face-wrap">
        <img id="faceImg" class="face-img" src="donkeyLove.jpg" alt="Face image for poop">
        <!-- poops will be created dynamically -->
      </div>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:10px">
        <button class="pie-button" id="pieBtn">Throw Poop!</button>
        <button class="pie-button" id="rapidPie">Rapid Poops</button>
      </div>
    </section>

    <!-- LETTERS -->
    <section class="block letter-area" id="lettersSection" aria-labelledby="lettersTitle">
      <div class="section-title"><h2 id="lettersTitle">💌 The 3 Letters</h2></div>
      <div class="center">
        <div id="letterHeadline" role="button" tabindex="0" aria-pressed="false">Click to reveal the envelope</div>

        <div class="letter-tabs" id="letterTabs" style="display:none" role="tablist" aria-label="Choose a letter">
          <button class="letter-tab" role="tab" id="tab-1" aria-selected="true" data-index="0">Letter 1</button>
          <button class="letter-tab" role="tab" id="tab-2" aria-selected="false" data-index="1">Letter 2</button>
          <button class="letter-tab" role="tab" id="tab-3" aria-selected="false" data-index="2">Letter 3</button>
        </div>

        <div class="envelope-viewport" id="envelopeViewport" aria-hidden="true" style="display:none">
          <div class="envelope enter" id="envelope" role="button" tabindex="0" aria-label="Envelope — click to open">
            <div class="face">📩 Open Me</div>
            <div class="back">Envelope back</div>
            <div class="letter-sheet" id="letterSheet" aria-hidden="true">
              <div class="stamp">Love Mail</div>
              <div class="letter-meta"><span id="letterCount">Letter 1 of 3</span><span>for Ishani</span></div>
              <div class="letter-title" id="letterTitle">To the Moon and Back</div>
              <div class="letter-content" id="letterContent"><!-- populated by JS --></div>
              <div class="signature" id="letterSignature">— Yours, always</div>
              <div class="wax-seal" aria-hidden="true">❤</div>
            </div>
          </div>
        </div>

        <div class="letter-cta" id="letterCta" style="display:none">
          <button class="btn" id="prevLetter">⬅️ Previous</button>
          <button class="btn" id="nextLetter">Next ➡️</button>
        </div>

        <div class="editor-ui" id="editorUI" style="display:none">
          <label class="muted">Edit selected letter (saved in your browser only):</label>
          <textarea id="letterEditor" class="editor" placeholder="Edit the visible letter here and click Save."></textarea>
          <div style="display:flex;gap:8px;justify-content:center">
            <button class="btn" id="saveLetter">Save</button>
            <button class="btn" id="resetLetter">Reset current</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer style="padding:30px 12px;text-align:center;opacity:.85">
    Made with too much love (and tiny donkey energy) 🫏
  </footer>

  <script>
    /* -------------------- helpful utils -------------------- */
    const $ = (sel,root=document)=>root.querySelector(sel);
    const $$ = (sel,root=document)=>[...root.querySelectorAll(sel)];
    const random = (min,max)=> Math.random()*(max-min)+min;

    /* -------------------- sparkles background -------------------- */
    (function spawnSparkles(){
      const root = $('#sparkles');
      const count = 14;
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.className='spark';
        const left = Math.random()*100;
        const top = Math.random()*100;
        el.style.left = left + '%';
        el.style.top = top + '%';
        const dur = random(10,22).toFixed(2)+'s';
        const delay = (-1 * random(0,10)).toFixed(2)+'s';
        el.style.animation = `float ${dur} linear ${delay} infinite`;
        root.appendChild(el);
      }
      const style = document.createElement('style');
      style.textContent = `
        @keyframes float { 0%{ transform: translateY(12vh) } 50%{ transform: translateY(-8vh) } 100%{ transform: translateY(12vh) } }
      `;
      document.head.appendChild(style);
    })();

    /* -------------------- DONKEY little heart + load effect -------------------- */
    const donkeyImg = $('#donkeyImg');
    donkeyImg.addEventListener('load', ()=> donkeyImg.classList.add('loaded'));

    /* -------------------- DIL: reveal + floating music notes -------------------- */
    (function initDil(){
      const dil = $('#dilPlayer');
      const vv = $('#dilVideo');
      const obs = new IntersectionObserver(entries=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            dil.classList.add('visible');
            spawnNotes();
          }
        })
      },{threshold:.35});
      obs.observe(dil);

      function spawnNotes(){
        const wrap = dil.parentElement;
        for(let i=0;i<10;i++){
          const n = document.createElement('div');
          n.className='music-note';
          n.textContent = Math.random()>0.5 ? '♪' : '♩';
          n.style.left = random(4,96)+'%';
          n.style.bottom = '-10px';
          n.style.fontSize = random(14,28)+'px';
          wrap.appendChild(n);
          const dy = random(80,160);
          const dur = random(3,6);
          n.animate([
            { transform:`translateY(0)`, opacity:.12 },
            { transform:`translateY(-${dy}px)`, opacity:0 }
          ], {duration: dur*1000, easing:'ease-out', fill:'forwards', delay: i*120});
          setTimeout(()=> n.remove(), (dur*1000)+1800);
        }
      }

      vv.addEventListener('play', ()=>{/* keep for future hooks if needed */});
    })();

    /* -------------------- THEATER: tap curtain to reveal -------------------- */
    (function theater(){
      const left = $('#curtainLeft'), right = $('#curtainRight'), screen = $('#screen');
      if(!left || !right) return;
      screen.addEventListener('click', ()=>{
        left.style.transition = right.style.transition = 'transform .9s cubic-bezier(.2,.9,.2,1)';
        left.style.transform = 'translateX(-90%)';
        right.style.transform = 'translateX(90%)';
        // ensure iframe is focusable/visible after a short beat
        setTimeout(()=> screen.querySelector('iframe')?.focus?.(), 600);
      }, {once:true});
    })();

    /* -------------------- 💩 POOP MY FACE (replaces pie) -------------------- */
    const faceImg = $('#faceImg');
    const pieBtn = $('#pieBtn');
    const rapidPie = $('#rapidPie');

    function throwPoopAtFace(x, y){
      createPoop(x, y);

      // small camera shake on section
      const sec = $('#pieSection');
      sec.classList.add('shake');
      setTimeout(()=> sec.classList.remove('shake'), 320);
    }

    function createPoop(pageX, pageY){
      const p = document.createElement('span');
      p.className = 'poop-emoji';
      p.textContent = '💩';
      // position (centered-ish)
      const size = 64;
      p.style.left = (pageX - size/2) + 'px';
      p.style.top  = (pageY - size/2) + 'px';
      document.body.appendChild(p);

      // drop-in animation
      requestAnimationFrame(()=>{
        const rot = 360 + Math.random()*360;
        p.style.transition = 'transform 420ms cubic-bezier(.2,.9,.2,1), opacity 240ms';
        p.style.opacity = '1';
        p.style.transform = `translateY(0) rotate(${rot}deg) scale(1)`;
      });

      // squish + fade + little “stink” waft
      setTimeout(()=>{
        p.style.transition = 'transform 300ms ease-out, opacity 400ms linear';
        p.style.transform = `translateY(-6px) rotate(15deg) scale(.88)`;

        // waft lines
        for(let i=0;i<2;i++){
          const w = document.createElement('div');
          w.style.position='absolute';
          w.style.left = (parseFloat(p.style.left) + random(16,42)) + 'px';
          w.style.top  = (parseFloat(p.style.top) - random(6,16)) + 'px';
          w.style.width='2px'; w.style.height='18px';
          w.style.borderRadius='2px';
          w.style.background='linear-gradient(180deg,#8b5b2e,#8b5b2e00)';
          w.style.opacity='0.5';
          w.style.transform='translateY(14px)';
          document.body.appendChild(w);
          w.animate([{transform:'translateY(14px)', opacity:.5},{transform:'translateY(-10px)', opacity:0}], {duration:1200, easing:'ease-out', fill:'forwards'});
          setTimeout(()=> w.remove(), 1400);
        }
      }, 460);

      setTimeout(()=>{ p.style.opacity='0'; setTimeout(()=> p.remove(), 420); }, 1400);
    }

    // interactions
    faceImg.addEventListener('click', (e)=> {
      throwPoopAtFace(e.pageX, e.pageY);
    });
    pieBtn.addEventListener('click', ()=>{
      const rect = faceImg.getBoundingClientRect();
      const x = rect.left + rect.width/2 + window.scrollX + random(-40,40);
      const y = rect.top  + rect.height/2 + window.scrollY + random(-40,40);
      throwPoopAtFace(x,y);
    });
    rapidPie.addEventListener('click', ()=>{
      let n = 12;
      const timer = setInterval(()=>{
        const rect = faceImg.getBoundingClientRect();
        const x = rect.left + random(0, rect.width) + window.scrollX;
        const y = rect.top  + random(0, rect.height) + window.scrollY;
        throwPoopAtFace(x,y);
        if(--n<=0) clearInterval(timer);
      }, 120);
    });

    /* -------------------- LETTERS: content (exactly as in your file) -------------------- */
    const LETTERS = [
      {
        title: "To the Moon and Back",
        signature: "— Yours, always",
        html: `
          <div class="letter-text-line">
          I love you to the moon and back Baby there is no limit to how much I love you and sometimes words feel too small to explain it. But still I want you to know that my love for you is endless. When I say I love you to the moon and back it’s not just a line it’s the truth of my heart. I love you everthing about you you're smile, you're eyes, you're lips, you're voice I love everything that you do I love you I love you so much that even if I tried to count it would never end. From the moment I wake up till the time I close my eyes at night tum mere dil mein ho. Every heartbeat is a reminder that I’m made to love you. Baby no distance no fight no sadness can ever change how much I love you. My love for you grows every single day and I know it will keep growing forever. So when I say I love you to the moon and back it means that even if the world ends my love for you will still remain. Ishani You asked me once why I chose you and my answer is simple because nothing has ever felt more real you are a place for my heart to rest, the hand I reach for in dark and light. Loving you wasn't a decision, it was something I realized I had already done.I love you and I'll never in this life love anyone else ever again you're going to be my last love and I'll always love you. I love you to the moon and back and much much more baby to infinity and beyond............
          </div>
        `
      },
      {
        title: "Some of the Reasons I Love You",
        signature: "— Forever yours",
        html: `
          <ul>
            <li class="letter-text-line">I love the way tum mera naam pyaar se bolte ho.</li>
            <li class="letter-text-line">I love jab tum bina wajah mujhe irritate karte ho bas meri reaction dekhne ke liye.</li>
            <li class="letter-text-line">I love the way tum gussa karte ho aur phir khud hi pighal jaate ho.</li>
            <li class="letter-text-line">I love ki tum mere har stupid joke pe bhi hasta dete ho.</li>
            <li class="letter-text-line">I love how tum mujhe samajh jaate ho bina main kuch bolun.</li>
            <li class="letter-text-line">I love ki tum meri silence ko bhi feel kar lete ho.</li>
            <li class="letter-text-line">I love jab tum randomly bol dete ho “I love you” bina reason ke.</li>
            <li class="letter-text-line">I love ki tum raat ko sirf meri awaaz sunane ke liye call karte ho.</li>
            <li class="letter-text-line">I love the way tum mujhe apna best friend aur lover dono banake rakhte ho.</li>
            <li class="letter-text-line">I love ki tum kabhi kabhi mummy ki tarah mujhe daant dete ho.</li>
            <li class="letter-text-line">I love jab tum meri care karte ho jaise main sabse special hoon.</li>
            <li class="letter-text-line">I love ki tum din mein 100 baar poochte ho “khana khaya na.”</li>
            <li class="letter-text-line">I love ki tum mujhe hamesha priority dete ho.</li>
            <li class="letter-text-line">I love the way tum mujhe motivate karte ho jab main give up karne lagta hoon.</li>
            <li class="letter-text-line">I love ki tum apne sapne mere saath share karte ho.</li>
            <li class="letter-text-line">I love ki tum apne har chhoti badi baat mujhe batana pasand karte ho.</li>
            <li class="letter-text-line">I love jab tum khud ke jokes pe khud hi haste ho.</li>
            <li class="letter-text-line">I love the way tum gussa hone ke baad chup ho jaate ho aur mujhe tension dete ho.</li>
            <li class="letter-text-line">I love jab tum bolte ho “mujhe abhi chocolate chahiye.”</li>
            <li class="letter-text-line">I love ki tum mujhe apni diary ki tarah treat karte ho.</li>
            <li class="letter-text-line">I love jab tum ignore karne ka drama karte ho.</li>
            <li class="letter-text-line">I love the way tum possessive hoke bolte ho “tum sirf mere ho.”</li>
            <li class="letter-text-line">I love jab tum bolte ho ki “main tumhare bina reh nahi sakti.”</li>
            <li class="letter-text-line">I love jab tum mujhe tease karte ho hasi hasi mein.</li>
            <li class="letter-text-line">I love ki tum mujhe hamesha confident feel karate ho.</li>
            <li class="letter-text-line">I love jab tum apne future ke plans mein mujhe include karte ho.</li>
            <li class="letter-text-line">I love the way tum mujhe hug karte ho jaise main poori duniya hoon tumhari.</li>
            <li class="letter-text-line">I love ki tum mere bina ek din bhi reh nahi paate aur turant miss karte ho.</li>
            <li class="letter-text-line">I love the way tum “baby” bolte ho aur mera din ban jaata hai.</li>
            <li class="letter-text-line">I love ki tum mujhe kabhi baccha treat karte ho aur kabhi ek strong banda.</li>
            <li class="letter-text-line">I love jab tum apna gussa sirf mujhpe nikalte ho aur dusron pe nahi.</li>
            <li class="letter-text-line">I love ki tum mere messages ka reply fast dete ho chahe busy ho.</li>
            <li class="letter-text-line">I love jab tum bolte ho “tum mere ho aur bas mere hi rahoge.”</li>
            <li class="letter-text-line">I love ki tum mujhe bina try kiye special feel karate ho.</li>
            <li class="letter-text-line">I love jab tum attitude dikhate ho bas mujhe tang karne ke liye.</li>
            <li class="letter-text-line">I love jab tum chhoti si compliment dete ho aur main blush karne lagta hoon.</li>
            <li class="letter-text-line">I love jab tum randomly bol dete ho ki “mujhe tumhari yaad aa rahi hai.”</li>
            <li class="letter-text-line">I love ki tum mujhe apne phone aur secrets trust karke dete ho.</li>
            <li class="letter-text-line">I love the way tum mujhe apna safe space banate ho.</li>
            <li class="letter-text-line">I love jab tum apni selfies bhejte ho sirf meri reaction ke liye.</li>
            <li class="letter-text-line">I love jab tum mujhe “pagal” bolke hasi nikalte ho.</li>
            <li class="letter-text-line">I love ki tum mujhe apna sabse close person mante ho.</li>
            <li class="letter-text-line">I love the way tum mujhe har situation mein support karte ho.</li>
            <li class="letter-text-line">I love jab tum apni problems mujhe batate ho bina jhijhak.</li>
            <li class="letter-text-line">I love ki tum mujhe hamesha believe karte ho.</li>
            <li class="letter-text-line">I love jab tum chhoti si jealousy dikhate ho.</li>
            <li class="letter-text-line">I love jab tum mera mood instantly change kar dete ho.</li>
            <li class="letter-text-line">I love jab tum mujhse apna favourite song share karte ho.</li>
            <li class="letter-text-line">I love ki tum meri har baat seriously lete ho.</li>
            <li class="letter-text-line">I love the way tum mere liye effort karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apni shopping choices mein involve karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe bolte ho ki main tumhari jaan hoon.</li>
            <li class="letter-text-line">I love ki tum hamesha meri izzat karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apni chhoti chhoti khushiyan share karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe bina wajah miss karte ho.</li>
            <li class="letter-text-line">I love ki tum mujhe har galti ke baad maaf kar dete ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apna lucky charm mante ho.</li>
            <li class="letter-text-line">I love ki tum hamesha mujhe better banne ke liye push karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe chhoti chhoti surprises dete ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apni life ka best part bolte ho.</li>
            <li class="letter-text-line">I love ki tum meri care karte ho jaise main tumhara baby hoon.</li>
            <li class="letter-text-line">I love jab tum mujhe bina reason hugs dete ho.</li>
            <li class="letter-text-line">I love jab tum mere liye cute sa gussa karte ho.</li>
            <li class="letter-text-line">I love ki tum mujhe apna first priority mante ho.</li>
            <li class="letter-text-line">I love jab tum mere saath apni funny childhood stories share karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe respect ke saath pyaar karte ho.</li>
            <li class="letter-text-line">I love ki tum meri kamiya bhi accept karte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe “meri jaan” bolte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe inspire karte ho.</li>
            <li class="letter-text-line">I love ki tum hamesha mere side pe khade hote ho no matter what.</li>
            <li class="letter-text-line">I love jab tum mujhe suljhate ho jab main confuse hota hoon.</li>
            <li class="letter-text-line">I love ki tum mujhe kabhi akela feel nahi karne dete.</li>
            <li class="letter-text-line">I love jab tum mujhe apni diary ke jaise treat karte ho.</li>
            <li class="letter-text-line">I love ki tum mujhe hamesha apna best dikhana chahte ho.</li>
            <li class="letter-text-line">I love jab tum mujhe phone karke bas chup rehte ho.</li>
            <li class="letter-text-line">I love ki tum meri life mein hamesha honesty leke aaye ho.</li>
            <li class="letter-text-line">I love jab tum mujhe pyaar se tang karte ho.</li>
            <li class="letter-text-line">I love ki tum meri aankhon mein dekh kar sab samajh jaate ho.</li>
            <li class="letter-text-line">I love jab tum meri family ke saath bhi pyar se behave karte ho.</li>
            <li class="letter-text-line">I love ki tum mujhe har din naya pyaar feel karate ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apne liye perfect mante ho.</li>
            <li class="letter-text-line">I love ki tum meri duniya ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apna forever bolte ho.</li>
            <li class="letter-text-line">I love ki tum mere har dukh ko apna bana lete ho.</li>
            <li class="letter-text-line">I love jab tum mujhe apne favourite person bolte ho.</li>
            <li class="letter-text-line">I love ki tum meri life ka sabse acha decision ho.</li>
            <li class="letter-text-line">I love jab tum mujhe raat ko goodnight wish karte ho.</li>
            <li class="letter-text-line">I love ki tum meri subah ka reason ho smile karne ka.</li>
            <li class="letter-text-line">I love jab tum mujhe apna soulmate mante ho.</li>
            <li class="letter-text-line">I love ki tum meri har heartbeat mein ho.</li>
            <li class="letter-text-line">I love jab tum mujhe khud pe proud feel karwate ho.</li>
            <li class="letter-text-line">I love you because tum meri zindagi ka sabse beautiful gift ho.</li>
          </ul>
        `
      },
      {
        title: "I’m Sorry Baby",
        signature: "— I’ll always try harder",
        html: `
          <div class="letter-text-line">
          I just want to say I’m really really sorry. I know I make mistakes and i'm literally the stupidest person in this world currently but trust me I never want to hurt you. Tum meri sabse special cheez ho hai aur main hamesha bas yahi chahta hoon ki tum khush raho whatever it may take I promise I’ll be better. I’ll learn from every mistake and make sure I never repeat it again. Main kuch bhi karunga bas taaki tum smile karo I love you're smile and I can do whatevr it takes to see that. I wish Ishani that you could see yourself from my eyes honestly you'd fall head over heels for yourself Ishani ik I fall short to show you how much you mean to me and I'm really sorry for that ik you feel like you have to ask things from me and then only it gets done and that i don't do anything from my end Ishani I'm really really sorry for that there's honestly no explanation for my wrongdoing except that i'm the world's biggest idiot keeping the most beautiful girl n this wole wide world sad and Ishani ik i just say it but i will spend the rest of my time in this world with the only thing i treasure and that's you and I'll make sure that you know that You deserve all the love and happiness in the world and I’ll do everything I can to give that to you. Please forgive me baby. I love you endlessly and I’ll always keep trying to be the best for you.
          </div>
        `
      }
    ];

    /* -------------------- LETTER interactions & editor -------------------- */
    const letterHeadline = $('#letterHeadline');
    const envelopeViewport = $('#envelopeViewport');
    const envelope = $('#envelope');
    const letterSheet = $('#letterSheet');
    const letterContent = $('#letterContent');
    const letterTitle = $('#letterTitle');
    const letterCount = $('#letterCount');
    const letterSignature = $('#letterSignature');
    const editorUI = $('#editorUI');
    const letterEditor = $('#letterEditor');
    const saveLetterBtn = $('#saveLetter');
    const resetLetterBtn = $('#resetLetter');
    const editToggle = $('#editToggle');
    const resetAllBtn = $('#resetAll');
    const letterTabs = $('#letterTabs');
    const prevLetterBtn = $('#prevLetter');
    const nextLetterBtn = $('#nextLetter');
    const letterCta = $('#letterCta');

    const STORAGE_KEYS = ['forgive_letter_1','forgive_letter_2','forgive_letter_3'];
    let currentLetter = 0; // 0..2
    let flipped = false;

    // Load any saved edits
    LETTERS.forEach((L, idx)=>{
      const saved = localStorage.getItem(STORAGE_KEYS[idx]);
      if(saved && saved.trim()){
        L.html = saved; // keep user's edited HTML
      }
    });

    function setTabActive(i){
      $$('.letter-tab').forEach((b,idx)=>{
        b.setAttribute('aria-selected', String(idx===i));
      });
    }

    function renderLetter(i){
      const L = LETTERS[i];
      letterTitle.textContent = L.title;
      letterSignature.textContent = L.signature;
      letterCount.textContent = `Letter ${i+1} of ${LETTERS.length}`;
      letterContent.innerHTML = L.html;

      // update editor with current HTML
      letterEditor.value = L.html;
      setTabActive(i);

      if(flipped){
        // re-run line reveals
        const nodes = $$('.letter-text-line', letterContent);
        nodes.forEach((n,idx)=> setTimeout(()=> { n.style.opacity='1'; n.style.transform='translateY(0)'; }, 130 + idx*120));
      }
    }

    // headline click reveals envelope & tabs
    letterHeadline.addEventListener('click', ()=>{
      letterHeadline.setAttribute('aria-pressed','true');
      letterTabs.style.display = 'flex';
      envelopeViewport.style.display = 'grid';
      letterCta.style.display = 'flex';
      renderLetter(currentLetter);
    });

    // tabs
    $$('.letter-tab').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        currentLetter = Number(btn.dataset.index||0);
        renderLetter(currentLetter);
      });
    });

    // envelope flip to reveal letter
    function flipEnvelope(){
      flipped = !flipped;
      if(flipped){
        envelope.classList.add('flipped');
        setTimeout(()=> {
          letterSheet.classList.add('visible');
          const nodes = $$('.letter-text-line', letterSheet);
          nodes.forEach((n,idx)=>{ setTimeout(()=>{ n.style.opacity='1'; n.style.transform='translateY(0)'; }, 130 + idx*140); });
        }, 420);
      } else {
        letterSheet.classList.remove('visible');
        $$('.letter-text-line', letterSheet).forEach(n=>{ n.style.opacity='0'; n.style.transform='translateY(6px)'; });
        setTimeout(()=> envelope.classList.remove('flipped'), 200);
      }
    }
    envelope.addEventListener('click', flipEnvelope);
    envelope.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); flipEnvelope(); } });

    // prev/next
    prevLetterBtn.addEventListener('click', ()=>{ currentLetter = (currentLetter + LETTERS.length - 1) % LETTERS.length; renderLetter(currentLetter); });
    nextLetterBtn.addEventListener('click', ()=>{ currentLetter = (currentLetter + 1) % LETTERS.length; renderLetter(currentLetter); });

    // save & reset for current letter
    saveLetterBtn.addEventListener('click', ()=>{
      const val = letterEditor.value || '';
      localStorage.setItem(STORAGE_KEYS[currentLetter], val);
      LETTERS[currentLetter].html = val;
      renderLetter(currentLetter);
      alert('Saved in your browser ✔️');
    });
    resetLetterBtn.addEventListener('click', ()=>{
      if(confirm('Reset just this letter to original (clear saved content)?')){
        localStorage.removeItem(STORAGE_KEYS[currentLetter]);
        location.reload();
      }
    });

    // edit toggle (global)
    editToggle.addEventListener('click', ()=>{
      const on = editToggle.getAttribute('aria-pressed') === 'true';
      editToggle.setAttribute('aria-pressed', String(!on));
      editToggle.textContent = `✏️ Edit: ${!on ? 'On' : 'Off'}`;
      editorUI.style.display = !on ? 'block' : 'none';
    });

    // reset all
    resetAllBtn.addEventListener('click', ()=>{
      if(confirm('Reset everything saved for this page? This will clear the saved letters.')) {
        STORAGE_KEYS.forEach(k=> localStorage.removeItem(k));
        location.reload();
      }
    });

    /* keyboard shortcut: L */
    document.addEventListener('keydown', (e)=>{
      if(e.key.toLowerCase() === 'l'){
        if(letterHeadline) letterHeadline.click();
        if(!flipped) setTimeout(()=> flipEnvelope(), 600);
      }
    });

    /* prefetch images & mark donkey loaded if cached */
    if(donkeyImg.complete) donkeyImg.classList.add('loaded');

    /* accessibility & cleanup */
    window.addEventListener('beforeunload', ()=> {
      const vids = $$('video');
      vids.forEach(v=>{ try{ v.pause(); }catch(e){} });
    });

    /* gentle entrance nudge */
    window.addEventListener('load', ()=>{
      setTimeout(()=> {
        const els = ['#donkeySection','#dilSection','#theaterSection','#pieSection','#lettersSection'];
        els.forEach((sel)=>{ const el = $(sel); if(el) el.style.transform = 'translateY(6px)'; });
      }, 240);
    });
  </script>
</body>
</html>
